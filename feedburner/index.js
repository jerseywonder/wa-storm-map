
var fetch = require('node-fetch');
var fs = require('fs')
var parseString = require('xml2js').parseString;
var xml2js = require('xml2js');


var turf = require('@turf/turf');
var fs = require('fs');
//var moment = require("moment-timezone")
//var path = require("path")

var app = {

  	xml: (url="https://www.emergency.wa.gov.au/data/message.rss") => {

    fetch(url)
        .then(res => res.text())
        .then(xml => app.parse(xml));

  	},

	parse: (xml) => {

		parseString(xml, (err, json) => {

      //app.writer(json.rss.channel[0].item[0])

      var current = 0

      for (var i = 0; i < json.rss.channel[0].item.length; i++) {

        //console.log(json.rss.channel[0].item[i].title) //["georss:alertLevel"]

        if (json.rss.channel[0].item[i]["georss:polygon"]!=undefined) {

          //console.log(json.rss.channel[0].item[i]["georss:polygon"].length)

          for (var feed of json.rss.channel[0].item[i]["georss:polygon"]) {

            app.wrangle(feed, current)

            current++

          }

        }

        //app.wrangle(json.rss.channel[0].item[i]["georss:polygon"][0], i)

      }

      
      //console.log(json.rss.channel[0].item.length)
      /*
      {
        "title": ["Bushfire Emergency Warning for parts of THE VINES, BAILUP, ELLENBROOK, GIDGEGANNUP, MILLENDON, WALYUNGA NATIONAL PARK, UPPER SWAN, AVELEY, HENLEY BROOK, AVON VALLEY NATIONAL PARK, RED HILL, BELHUS, BASKERVILLE, HERNE HILL, BULLSBROOK, WOOROLOO and BRIGADOON in the SHIRES OF MUNDARING and NORTHAM and the CITY OF SWAN"],
        "link": ["https://www.emergency.wa.gov.au/#map/warning/bew_405221456"],
        "description": ["\n<div>\n<b>Category: </b>Bushfire</div>\n<div>\n<b>Alert Summary: </b>Bushfire EMERGENCY WARNING for parts of THE VINES, BAILUP, ELLENBROOK, GIDGEGANNUP, MILLENDON, WALYUNGA NATIONAL PARK, UPPER SWAN, AVELEY, HENLEY BROOK, AVON VALLEY NATIONAL PARK, RED HILL, BELHUS, BASKERVILLE, HERNE HILL, BULLSBROOK, WOOROLOO and BRIGADOON in the SHIRES OF MUNDARING and NORTHAM and the CITY OF SWAN</div>\n<div>\n<b>Content:</b><div id=\"main-wrapper\"><table style=\"width: 100%; padding: 0px; border-spacing: 0px; border: none;\">\n    <tr>\n        <td style=\"padding: 15px 20px 15px;\">\n            <div><p><strong>The following alert has been issued by the Department of Fire and Emergency Services (DFES)</strong>\n</p>\n<p style=\"text-align:center; color:#B60000\">People who have evacuated will not be able to return home until directed by authorities. Firefighters are expecting strong south easterly winds to push the fire in a north/northwest direction today. People in the Shady Hills Estate area need to keep up to date and enact their bushfire plan early. Please note changes throughout the alert. Important: You need to protect yourself and your family from the immediate danger of the bushfire first and foremost. Whether you are in lockdown or have been personally directed to quarantine for COVID-19, you must do whatever you need to do to keep yourself and your loved ones safe.\n</p>\n<p>\n  <br/><span style=\"color:#777777\">Time of issue: 11:25 AM</span>\n  <br/><span style=\"color:#777777\">Date of issue: 03 February 2021</span>\n</p>\n<!-- @Start{ALERT INFO} -->\n<!-- @Start{EMERGENCY WARNING} -->\n\n<p>\n  <br/><span style=\"font-size:18px;\"><strong>Bushfire EMERGENCY WARNING for parts of THE VINES, BAILUP, ELLENBROOK, GIDGEGANNUP, MILLENDON, WALYUNGA NATIONAL PARK, UPPER SWAN, AVELEY, HENLEY BROOK, AVON VALLEY NATIONAL PARK, RED HILL, BELHUS, BASKERVILLE, HERNE HILL, BULLSBROOK, WOOROLOO and BRIGADOON in the SHIRES OF MUNDARING and NORTHAM and the CITY OF SWAN</strong></span>\n</p>\n<p><span style=\"color:#777777\"><strong>ALERT LEVEL:</strong></span>\n  <br/>\n  <br/>A bushfire EMERGENCY WARNING is in place for people in parts of THE VINES, BAILUP, ELLENBROOK, GIDGEGANNUP, MILLENDON, WALYUNGA NATIONAL PARK, UPPER SWAN, AVELEY, HENLEY BROOK, AVON VALLEY NATIONAL PARK, RED HILL, BELHUS, BASKERVILLE, HERNE HILL, BULLSBROOK, WOOROLOO and BRIGADOON in the SHIRES OF MUNDARING and NORTHAM and the CITY OF SWAN.\n</p>\n<ul><li>You are in danger and need to act immediately to survive. There is a threat to lives and homes.</li>\n  \n</ul>\n<p><span style=\"color:#777777\"><strong>WHAT TO DO:</strong></span>\n  <br/><p style=\"color:#333333;margin-bottom:7.5pt;mso-list:l0 level1 lfo1;     tab-stops:list 36.0pt;background:white\" class=\"MsoNormal\">&nbsp;</p><ul><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\"><strong>For people within the marked Incident Area (the black shaded area within the map), it&rsquo;s too late to leave and leaving now would be deadly.</strong></li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">You need to shelter in your home in a room away from the fire front and make sure you can easily escape.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">You must shelter before the fire arrives, as the extreme heat will kill you well before the flames reach you.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">Close all doors and windows and turn off evaporative air conditioners, but keep water running through the system if possible.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">Choose a room with two exits and water such as a kitchen or laundry.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">If your home catches on fire and the conditions inside become unbearable, you need to get out and go to an area that has already been burnt.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">Protect yourself by wearing long sleeves and trousers, made from cotton or wool, and strong leather boots.&nbsp;</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">If you are on the northern side of the Incident Area, travel northeast, away from the fire.&nbsp;</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\"><strong>For people in the remainder of the Emergency Warning area if you are not prepared or you plan to leave, leave now if the way is clear by travelling in a west/south westerly direction. This advice applies to ALL people in this area, including people who have been directed to self-isolate or self-quarantine and people who are in an area subject to COVID-19 lockdown restrictions.</strong></li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\"><strong>If you are in an area subject to COVID-19 lockdown restrictions leave now, to a suitable premises or safer place, wear a mask and continue to follow precautions to minimise the spread of the virus.&nbsp;</strong></li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\"><strong>If you have been personally directed to self-isolate or self-quarantine due to COVID-19:</strong></li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">Leave now, find alternative suitable premises and wear a mask.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">If you are unable to return to your quarantine location within one hour, telephone WA Police on 131 444 to advise them you have had to leave due to an emergency.</li><li style=\"color: rgb(51, 51, 51); margin-bottom: 7.5pt; background: white;\" class=\"MsoNormal\">Regardless of your location, continue to follow COVID-19 precautions and maintain appropriate physical distancing.?<span style=\"font-size:12.5pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-font-family:      &quot;Times New Roman&quot;;mso-fareast-language:EN-AU\"><o:p><o:p>&nbsp;</o:p></o:p></span></li></ul><p style=\"color:#333333;margin-bottom:7.5pt;mso-list:l0 level1 lfo1;     tab-stops:list 36.0pt;background:white\" class=\"MsoNormal\">&nbsp;</p>\n</p>\n<!-- @End{EMERGENCY WARNING} -->\n<!-- @Start{WATCH AND ACT} -->\n\n<p>\n  <br/><span style=\"font-size:18px;\"><strong>Bushfire WATCH AND ACT for parts of BEECHINA, DAYTON, BAILUP, ELLENBROOK, GIDGEGANNUP, COPLEY, WEST SWAN, MILLENDON, HENLEY BROOK, BRABHAM, HOVEA, AVELEY, LOWER CHITTERING, CAVERSHAM, STRATTON, AVON VALLEY NATIONAL PARK, STONEVILLE, WUNDOWIE, MIDDLE SWAN, PARKERVILLE, MORANGUP, RED HILL, MOUNT HELENA, MUCHEA, JANE BROOK, LEXIA, HERNE HILL, MELALEUCA, CHIDLOW, WHITEMAN, BULLSBROOK, WOOROLOO, BENNETT SPRINGS in the SHIRES OF TOODYAY, MUNDARING, NORTHAM and the CITY OF SWAN</strong></span>\n</p>\n<p><span style=\"color:#777777\"><strong>ALERT LEVEL:</strong></span>\n  <br/>\n  <br/>A bushfire WATCH AND ACT is in place for people parts of BEECHINA, DAYTON, BAILUP, ELLENBROOK, GIDGEGANNUP, COPLEY, WEST SWAN, MILLENDON, HENLEY BROOK, BRABHAM, HOVEA, AVELEY, LOWER CHITTERING, CAVERSHAM, STRATTON, AVON VALLEY NATIONAL PARK, STONEVILLE, WUNDOWIE, MIDDLE SWAN, PARKERVILLE, MORANGUP, RED HILL, MOUNT HELENA, MUCHEA, JANE BROOK, LEXIA, HERNE HILL, MELALEUCA, CHIDLOW, WHITEMAN, BULLSBROOK, WOOROLOO, BENNETT SPRINGS in the SHIRES OF TOODYAY, MUNDARING, NORTHAM and the CITY OF SWAN.\n</p>\n<ul><li>There is a possible threat to lives and homes as a fire is approaching in the area and conditions are changing.</li><li>The fire started near WERRIBEE RD in WOOROLOO.</li>\n  \n</ul>\n<p><span style=\"color:#777777\"><strong>WHAT TO DO:</strong></span>\n  <br/><ul><li>If you are not prepared or you plan to leave, leave now if the way is clear.</li><li>If you are well prepared and plan to actively defend your home, make final preparations now.</li><li>If you plan to stay and actively defend, do not rely on mains water pressure as it may be affected. You need to have access to an independent water supply, and start patrolling your property to  put out spot fires.</li><li>At all times close all doors and windows and turn off evaporative air conditioners, but keep water running through the system if possible.</li><li>If you are not at home, do not try to return as conditions in the area could be very dangerous.</li></ul><b>If you are self-isolating or quarantining due to COVID-19 and plan to leave:</b><ul><li>Leave now, find alternative suitable premises and wear a mask.</li><li>If you are unable to return to your quarantine location within one hour, telephone WA Police on 131 444 to advise them you have had to leave due to an emergency.</li><li>Regardless of your location, continue to follow COVID-19 precautions and maintain appropriate physical distancing.</li></ul>\n</p>\n\n<!-- @End{WATCH AND ACT} -->\n<!-- @Start{ADVICE} -->\n\n<p>\n  <br/><span style=\"font-size:18px;\"><strong>Bushfire ADVICE for parts of MALAGA, MARANGAROO, ASHBY, BAILUP, CULLACABARDEE, GIDGEGANNUP, KOONDOOLA, CARRAMAR, WANNEROO, BALLAJURA, MOONDYNE, LOWER CHITTERING, NEERABUP, JANDABUP, PINJAR, AVON VALLEY NATIONAL PARK, MARIGINIUP, DARCH, MADELEY, BANKSIA GROVE, HOCKING, MORANGUP, BALGA, CARABOODA, TAPPING, MUCHEA, GIRRAWHEEN, CHITTERING, YEAL, LANDSDALE, LEXIA, SINAGRA, GNANGARA, YANCHEP, MELALEUCA, WHITEMAN, PEARSALL, WANGARA, BULLSBROOK, MIRRABOOKA, ALEXANDER HEIGHTS, NOWERGUP, JULIMAR, BENNETT SPRINGS in the SHIRE OF MUNDARING, TOODYAY, CHITTERING and GINGIN and the CITY OF SWAN, WANNEROO and STIRLING</strong></span>\n</p>\n<p><span style=\"color:#777777\"><strong>ALERT LEVEL:</strong></span>\n  <br/>\n  <br/>A bushfire ADVICE is in place for people parts of MALAGA, MARANGAROO, ASHBY, BAILUP, CULLACABARDEE, GIDGEGANNUP, KOONDOOLA, CARRAMAR, WANNEROO, BALLAJURA, MOONDYNE, LOWER CHITTERING, NEERABUP, JANDABUP, PINJAR, AVON VALLEY NATIONAL PARK, MARIGINIUP, DARCH, MADELEY, BANKSIA GROVE, HOCKING, MORANGUP, BALGA, CARABOODA, TAPPING, MUCHEA, GIRRAWHEEN, CHITTERING, YEAL, LANDSDALE, LEXIA, SINAGRA, GNANGARA, YANCHEP, MELALEUCA, WHITEMAN, PEARSALL, WANGARA, BULLSBROOK, MIRRABOOKA, ALEXANDER HEIGHTS, NOWERGUP, JULIMAR, BENNETT SPRINGS in the SHIRE OF MUNDARING, TOODYAY, CHITTERING and GINGIN and the CITY OF SWAN, WANNEROO and STIRLING.\n</p>\n<ul><li>There is a lot of smoke in the area.</li><li>Although there is no immediate danger you need to be aware and keep up to date in case the situation changes.</li><li>The fire started near WERRIBEE RD in WOOROLOO.</li><li>People in this area can expect smoke and ash throughout the day.</li>\n</ul>\n<p><span style=\"color:#777777\"><strong>WHAT TO DO:</strong></span>\n  <br/><ul><li>Stay alert and monitor your surroundings.</li><li>Watch for signs of a bushfire, especially smoke and flames.</li><li>Close all doors and windows, and turn off evaporative air conditioners but keep water running through the system if possible.</li><li>Read through your bushfire survival plan.</li><li>If you do not have a plan decide what you will do if the situation gets worse.</li></ul><p>If driving</p><ul><li>Be extremely careful when driving through the area.</li><li>Turn your headlights on and drive slowly.</li><li>Watch for emergency services personnel and follow their directions.</li><li>If you cannot see clearly, pull over, keep your headlights and hazard lights on, and wait until the smoke clears.</li><li>If you have a respiratory condition and you have been affected by smoke you should contact your local doctor or call Health Direct on 1800 022 222.</li></ul>\n</p>\n\n<!-- @End{ADVICE} -->\n<!-- @Start{ALL CLEAR} -->\n\n<!-- @End{ALL CLEAR} -->\n<!-- @End{ALERT INFO} -->\n\n<p><span style=\"color:#777777\"><strong>BUSHFIRE BEHAVIOUR:</strong></span>\n</p>\n<ul><li>The bushfire is moving in a west - south westerly direction.</li> <li>It is out of control and unpredictable.</li> <li>Burning embers are likely to be blown around your home. Spot fires are starting up to 100 metres ahead of the fire.</li>   \n</ul> \n\n<p>\n  <br/><span style=\"color:#777777\"><strong>SAFER PLACE:</strong></span>\n  <br/><ul><li>The Department of Communities has set up the following&nbsp;evacuation centres:<ul><li>Brown Park Recreation Complex on Amherst Road, near the intersection of Salisbury Road, in Swan View.&nbsp;</li><li>Swan Active Midland - 16 Gray Dr, Midvale WA 6056.&nbsp;</li><li>Swan Active Beechboro - 332&nbsp;Benara Road, Beechboro.</li></ul></li><li><strong>A meeting for evacuees only will be held today at 1pm at Brown Park, Swan View. The general community is urged not to attend to minimise COVID-19 risks. An update will be posted for the general community on the DFES Facebook page.&nbsp;</strong></li><li>People who have been personally directed to self-isolate or quarantine due to COVID-19 should find alternative suitable premises and wear a mask.&nbsp;</li><li>If this is not possible, proceed to the evacuation centre and identify yourself to centre staff immediately on arrival.</li><li>Protocols are in place to minimise COVID-19 risk at the evacuation centre and you must follow the directions of centre staff.&nbsp;</li><li>Continue to follow COVID-19 precautions and maintain appropriate physical distancing.Please take any essential items such as medications and identification to the evacuation centre.</li><li>Pets (except recognised assistance animals) are not allowed inside evacuation centres for health and safety reasons, so you should make alternative arrangements for them. If this is not possible, please still proceed to the evacuation centre with your pets and await further advice.</li></ul>\n</p>\n\n<p>\n  <br/><span style=\"color:#777777\"><strong>SAFEST ROUTE:</strong></span>\n  <br/>If you are on the northern side of the Incident Area, travel northeast, away from the fire. For people in the remainder of the Emergency Warning area, if you are not prepared or you plan to leave, leave now if the way is clear by travelling in a west/south westerly direction. . \n</p>\n<p>\n  <br/><span style=\"color:#777777\"><strong>ROAD CLOSURES AND CONDITIONS:</strong></span>\n  <br/> <p>Avoid the area and be aware of fire and emergency services personnel working on site.<br />A number of roads have been closed including:</p><ul><li>Railway Parade between Neaves Road and Maralla Road.</li><li>Great Northern Highway closed from West Swan Road to Rutland Road.</li><li>Toodyay Road in both directions between Bunning Road to Bailup Road.</li><li>Weribee Road from Cheddaring Road to Linley Valley Road.</li><li>Government Road from Linley Valley Road to Jason Street.</li><li>Bailup Road from Burma Road to Government Road (Bailup Road is open from Toodyay Road to Burma Road).</li></ul>\n  <p>Please note there are dangerous road conditions within the area. Motorists are asked to avoid the area, reduce speed and drive carefully due to smoke and other hazards.</p><p>Road information may also be available from Main Roads WA by calling 138 138 or visiting <a target=\"_blank\" href=\"https://travelmap.mainroads.wa.gov.au/Home/Map\"><u>travelmap.mainroads.wa.gov.au</u></a> or by contacting the SHIRES OF MUNDARING, CHITTERING and NORTHAM and the CITY OF SWAN.</p>   \n</p>\n<p><strong><span style=\"color:#777777\">HEALTH:</span></strong>\n  <br/><p>Smoke is affecting people in areas from Joondalup to Rottnest Island to Fremantle in the Perth Metropolitan area.</p><p>People are reminded that if&nbsp;you have a respiratory condition and you have been affected by smoke you should contact your local doctor or call Health Direct on 1800 022 222.</p><p>&nbsp;</p>\n</p>\n<p><strong><span style=\"color:#777777\">POWER:</span></strong>\n  <br/><p>Western Power have advised that around 2000 homes and businesses are without power and&nbsp;are affected by power outages.&nbsp;For&nbsp;details on estmated restoration times&nbsp;visit&nbsp;<a href=\"http://www.westernpower.com.au/faults-outages/power-outages/\">www.westernpower.com.au/faults-outages/power-outages</a></p>\n</p>\n<p><strong><span style=\"color:#777777\">REGISTER.FIND.REUNITE:</span></strong>\n  <br/>Register with Register.Find.Reunite to let your family and loved ones know you're OK and where you will be relocating to via <a href=\"https://register.redcross.org.au\" target=\"_blank\"><u>https://register.redcross.org.au</u></a> from any computer or mobile device or in person at the temporary evacuation centre.<br/><br/>If you are unable to contact a loved one who may have been planning to be in the area, enquire about their whereabouts through the online Register.Find.Reunite system at <a href=\"https://register.redcross.org.au\" target=\"_blank\"><u>https://register.redcross.org.au</u></a>.\n</p>\n<p><span style=\"color:#777777\"><strong>ANIMAL WELFARE:</strong></span>\n  <br/><p>For those in an area where it is not safe to leave:&nbsp;</p><ul><li>It is no longer safe to evacuate horses and large animals.</li><li>It is not safe to handle animal movements outside.&nbsp;</li><li>Fences along roadsides should not be cut and external property gates should not be opened.</li></ul><p>For other parts of the warning area where it is safe to leave:</p><ul><li>Take animals to stay with a friend or family member, or to a private boarding or agistment arrangement.</li><li>If evacuating livestock or horses isn&rsquo;t possible, consider moving animals to a paddock with low fire fuel load, and ensure animals have feed and drinking water for several days of high to extreme temperatures.</li><li>Fences along roadsides should not be cut and external property gates should not be opened.&nbsp;</li></ul><div>More information on managing animals in emergencies is available at <a href=\"https://aus01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.agric.wa.gov.au%2Fanimalwelfare%2Fresponding-animal-welfare-emergencies&data=04%7C01%7CKatrina.Bowers%40dpird.wa.gov.au%7C04448ae2d9764fd94dec08d8c7241191%7C7b5e7ee62d234b9aabaaa0beeed2548e%7C0%7C0%7C637478305009552931%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=thDcR%2BZgqaPQVkcJFvtUjd20h1mxgA%2Bw4NxtVq5mRSE%3D&reserved=0\">agric.wa.gov.au</a></div><div>&nbsp;</div><div>People who have evacuated and left animals behind, or may have fences damaged by fire putting animals at risk can contact the City of Swan for assistance on 9267 9267.</div><div>&nbsp;</div><div>The&nbsp;Department of Primary Industries and Regional Development have 12 vets supported by the City of Swan and Shire of Mundaring rangers ready to patrol the fire area, once the area is safe, from to&nbsp;Werribee&nbsp;Road&nbsp;in Woolooroo to&nbsp;Reen Road in Gidgegannup.&nbsp;</div><div>&nbsp;</div><div>Wildcare Helpline: 08&nbsp;9474 9055 or&nbsp;<a href=\"https://www.dpaw.wa.gov.au/about-us/contact-us/wildcare-helpline\">www.dpaw.wa.gov.au/about-us/contact-us/wildcare-helpline</a></div><div>&nbsp;</div><div>&nbsp;</div>\n</p>\n\n<p>\n  <br/><span style=\"color:#777777\"><strong>WHAT FIREFIGHTERS ARE DOING:</strong></span>\n</p>\n<ul><li>Firefighters are on the scene, actively fighting the fire on northern and western sides of the fire.</li>\n  <li>300 Career Fire and Rescue Service, Volunteer Fire and Rescue Service, Bush Fire Service Volunteers, Volunteer Fire and Emergency Services, Parks and Wildlife Service and Forest Products Commission firefighters are attending.</li>\n  <li>Aerial support has been sent to protect crews and homes.</li>\n  \n  <li><p>Western Power, WAPOL, Local Government representatives, Main Roads, St John Ambulance,&nbsp;and SES volunteers are also in attendance</p></li>\n</ul>\n\n\n<p>\n  <br/><span style=\"color:#777777\"><strong>EXTRA INFORMATION:</strong></span>\n</p>\n\n\n<ul>\n  \n  \n  <li>The fire was reported at 12:02 PM on 1 February 2021. </li>\n   \n  \n  <li>Currently there has been 9,464 hectares burnt.</li>\n  \n  \n  <li>71 properties have been confirmed as lost.</li>\n  \n  \n  <li>The cause of the fire is unknown.</li>\n  \n  \n  <li>DFES is managing the fire.</li>\n  \n</ul>\n\n<p>\n  <br/><span style=\"color:#777777\"><strong>KEEP UP TO DATE:</strong></span>\n  <br/>\n  <br/>Visit <a href=\"https://www.emergency.wa.gov.au/\" target=\"_top\"><u>emergency.wa.gov.au</u></a>, call 13 DFES (13 3337), follow DFES on Twitter: <a href=\"https://twitter.com/dfes_wa\" target=\"_top\"><u>twitter.com/dfes_wa</u></a>, Facebook: <a href=\"https://www.facebook.com/dfeswa/\" target=\"_top\"><u>facebook.com/dfeswa</u></a>, listen to ABC Local Radio, 6PR, or news bulletins.<br/><br/>During a power outage, your home phone, computer or other electronic devices connected to the NBN will not work. Include a battery powered radio in your emergency kit.\n  <br/>\n  <br/>Updates will be issued every hour unless the situation changes.\n</p>\n<p>\n  <br/><span style=\"color:#777777\"><strong>END</strong></span>\n</p></div>\n        </td>\n    </tr>\n</table></div></div>"],
        "dfes:region": ["Metro North East, Metro"],
        "dfes:incidentNumber": ["512758"],
        "dfes:publicationTime": ["03/02/21 11:25 AM"],
        "pubDate": ["Wed, 3 Feb 2021 03:25:26 GMT"],
        "guid": ["405221456"],
        "geo:long": ["116.11486439490012"],
        "geo:lat": ["-31.736393370037966"],
        "georss:alertLevel": ["Bushfire Emergency Warning", "Bushfire Advice", "Bushfire Watch and Act", "Bushfire Advice"],
        "georss:polygon": ["-31.623860890811052,116.11262799200472\n-31.62341780846791,116.11233294901393\n-31.623342438581048,116.11224980053487\n-31.623230525606118,116.11195207533466\n-31.623229695893684,116.11192262342222\n-31.623302367078143,116.11195081281033\n-31.623274544963603,116.11198436661668\n-31.623300292798596,116.11193082721027\n-31.62331690487693,116.11193629640204\n-31.62331981332853,116.11184520606923\n-31.62331649448188,116.11181859352673\n-31.6233268792598,116.11175443005816\n-31.623338923459446,116.11163651763523\n-31.62334183191037,116.11200676725299\n-31.623341002198917,116.11167690793113\n-31.623294493737287,116.11196932110063\n-31.623398725118207,116.11126395251658\n-31.624087641380985,116.11120231409608\n-31.62440573003168,116.11090737587823\n-31.624521794558696,116.11106967571709\n-31.62536870570068,116.11106031417904\n-31.625600832207475,116.1110415911029\n-31.62758903682786,116.10894967761905\n-31.62724439156872,116.1010536733754\n-31.628507561237132,116.0983075104397\n-31.629661092293286,116.09450992157025\n-31.62964531992402,116.0919568776837\n-31.626750295506547,116.0859289481998\n-31.6267785581861,116.081016817666\n-31.62963047533876,116.0767500936758\n-31.63240922623223,116.07149631676899\n-31.63732536228973,116.06800206897566\n-31.640670195862953,116.06249080000312\n-31.649770685400295,116.05404318271225\n-31.650489918320893,116.0506877392355\n-31.65164752914373,116.04827643333188\n-31.652800559122053,116.04509801565003\n-31.653332546349066,116.0423058360663\n-31.65832120542968,116.03917033372892\n-31.661399884952903,116.03416935502152\n-31.670906961285603,116.0315716355911\n-31.6714274310673,115.98134995400545\n-31.678120583213463,115.98186568464943\n-31.68672573016228,115.97963446000598\n-31.698397262625154,115.98083646290108\n-31.729447487270455,115.97997964904287\n-31.74103661765859,115.98105402567529\n-31.762594881036076,115.97575472717594\n-31.76532268627883,115.97577693136134\n-31.765086225668757,115.97255977357028\n-31.771709123406755,115.96831264751765\n-31.77399008865563,115.96758457969223\n-31.77495760753148,115.9673714959976\n-31.78007077781539,115.96789842434038\n-31.7820435704245,115.97047931710047\n-31.780879009675907,115.97795255910292\n-31.795562850738598,115.97857781764738\n-31.795801350611885,116.00023159486551\n-31.802389782579578,115.99917555102711\n-31.807737760100817,116.00069442784256\n-31.807724436523294,116.00217038931363\n-31.807856994403082,116.00802371589667\n-31.807949581463347,116.01113806440654\n-31.80807028240488,116.01369395814024\n-31.808057692331726,116.01670997644848\n-31.807972161704594,116.01938267200288\n-31.822636399423697,116.01743488534423\n-31.82225786579987,116.02246084212315\n-31.82223008998837,116.02629003076738\n-31.82222054650249,116.02949694692033\n-31.822158795362174,116.03309436808419\n-31.82220643825512,116.0361124321007\n-31.822028238820035,116.0411829648885\n-31.82210941645389,116.0449296441735\n-31.822135896985895,116.04779655890178\n-31.822071215747012,116.05592060329852\n-31.82431029709779,116.0636760849355\n-31.82573063994309,116.06898076094964\n-31.825309575363224,116.08162396082754\n-31.821112712016376,116.12768138719171\n-31.81884186349588,116.13771516440676\n-31.816716826595805,116.15684699459896\n-31.816196304643466,116.16730992525639\n-31.815092301931188,116.18257937446779\n-31.814614751219924,116.1907425518749\n-31.813663114688538,116.19605185889046\n-31.812820873545206,116.20127533521776\n-31.812387596879574,116.20530351024331\n-31.8119156770021,116.20890546549278\n-31.811789122574677,116.22276565484702\n-31.81177197440973,116.225553685389\n-31.811679947650763,116.22870595153317\n-31.811386487094854,116.23213515575819\n-31.81109302560661,116.23547852929488\n-31.810925495717576,116.23849601443612\n-31.810976780409725,116.24091268475799\n-31.810699842733747,116.24573261435698\n-31.812111304484123,116.24734864528824\n-31.813595680835167,116.24982298310424\n-31.821961305165367,116.2578508346847\n-31.82554959638549,116.25965596135127\n-31.8255259521793,116.26905241008139\n-31.829093879863933,116.27145365770147\n-31.826767692118437,116.28084809477475\n-31.824448852460126,116.28575385506228\n-31.820671355031173,116.28877134020357\n-31.818206497370852,116.29316211636043\n-31.81339852511975,116.29611522848539\n-31.807532665165702,116.29529179031792\n-31.807246599520443,116.30262226755463\n-31.806814650114514,116.31304264957622\n-31.803627131041853,116.31445657186724\n-31.800658341325374,116.31844541481232\n-31.795522933729657,116.31947081493674\n-31.794253746410707,116.32041038437256\n-31.793349303006043,116.3220365993162\n-31.788345285881856,116.32862728977904\n-31.787164658132426,116.34017788762415\n-31.787648709496086,116.34405300909788\n-31.788033155903225,116.34982914621087\n-31.787342918143434,116.35168255263989\n-31.784065500902912,116.35650516444778\n-31.780866629654078,116.35954142505175\n-31.778846472915824,116.36020661288724\n-31.777870580038694,116.36016369754262\n-31.7744548738791,116.35383368426804\n-31.77395778463178,116.34763241702628\n-31.76727190272062,116.34638787204344\n-31.757547779753974,116.34647370273176\n-31.75960831185355,116.33389682466253\n-31.75656025890208,116.3311904757669\n-31.75498887028407,116.32637859279478\n-31.75586009339326,116.32027388507758\n-31.757821455723697,116.30887986118371\n-31.741746181982247,116.30347252781003\n-31.726525928215533,116.27626419956566\n-31.711777782357487,116.18629754480035\n-31.63215573359817,116.12036348280496\n-31.63116916109481,116.11947298941143\n-31.628200245532803,116.11716897186788\n-31.62775261619748,116.11692489084736\n-31.626459960210372,116.11569778022319\n-31.62662896572396,116.11498565372959\n-31.625359133001243,116.1140763848733\n-31.62528148079759,116.11405224499218\n-31.625226667438366,116.11398921308013\n-31.624664828644377,116.1130303233573\n-31.624226317960023,116.11270041164832\n-31.623860890811052,116.11262799200472\n", "-31.85239663635711,116.26759430981933\n-31.856697959527263,116.26828095532582\n-31.855458615800863,116.2758340559094\n-31.85317125385897,116.28636977291866\n-31.845611620286586,116.29764577961573\n-31.846206297459776,116.30903443909139\n-31.835581846430394,116.32276064372311\n-31.834243378468592,116.3246884814523\n-31.831240656213616,116.3263390458246\n-31.830571393178666,116.32713130331227\n-31.84269684923416,116.32686710572435\n-31.84649879291952,116.3267350069304\n-31.84861843166863,116.32658312684495\n-31.85244868117427,116.32479057303296\n-31.854691813364447,116.32496717973275\n-31.85832001658816,116.32368466472866\n-31.861324420318656,116.32039527064852\n-31.866807158458794,116.32002411997614\n-31.871414889297665,116.31973879999221\n-31.876313936490043,116.3189384958775\n-31.880603325074947,116.31453564978023\n-31.88248744975934,116.31116277194448\n-31.884080014670182,116.30693158722413\n-31.884619783729878,116.30133649921989\n-31.88521762551528,116.29519155836769\n-31.88406634958965,116.28956160164627\n-31.88059763107671,116.28121993161118\n-31.879053405768534,116.27526542759902\n-31.878238007921343,116.26845261670223\n-31.88031520832394,116.26398942089878\n-31.88242880276106,116.26227280713566\n-31.884141507507792,116.26137158490329\n-31.885927059399545,116.2598695478583\n-31.88720243241484,116.2575521192646\n-31.88760326028587,116.25617882825411\n-31.887894770368987,116.24772450543702\n-31.888149840935245,116.24257466412966\n-31.88978956341911,116.23832604504572\n-31.88997175300444,116.23309037305471\n-31.892740990313722,116.22781178571289\n-31.896275290632932,116.22236153699474\n-31.89736834573627,116.22038743116266\n-31.898242780474682,116.21605298139504\n-31.898862166721972,116.21330639936505\n-31.900538132143616,116.2106027326769\n-31.903088455757466,116.2053670606769\n-31.904764344227193,116.1927499494775\n-31.905092231880065,116.18571183302173\n-31.904582183915537,116.18223569013568\n-31.902651262442337,116.17708584882833\n-31.901594703357485,116.16605660536656\n-31.901339670036847,116.16176507094077\n-31.900902468415026,116.15820309737106\n-31.900902468415026,116.15605733015367\n-31.900100926714657,116.1456289015045\n-31.898626378140893,116.14039323278335\n-31.898735681443277,116.1403503174409\n-31.89869924702359,116.14026448675146\n-31.89866281258904,116.14017865605834\n-31.898662812589283,116.13987824864999\n-31.89866281258922,116.13944909520625\n-31.898772115849013,116.13889119573598\n-31.898990721979043,116.13816163487728\n-31.89910002484875,116.13734624334066\n-31.899209327589322,116.1365737671458\n-31.899610103193794,116.13545796819734\n-31.899974443138095,116.13219640202841\n-31.89979227334592,116.1296214813764\n-31.898589943677884,116.12043759771666\n-31.901768796323942,116.10736987539462\n-31.902355419425152,116.10620044798038\n-31.902650576344545,116.10434437505829\n-31.902366500084828,116.10269216573735\n-31.901434012209943,116.09981690053802\n-31.901244960671438,116.09586881459742\n-31.900356785048714,116.0892601030428\n-31.900998821283977,116.08574129627263\n-31.900839317770615,116.08299496569879\n-31.900848212687173,116.0808067860571\n-31.900492771152134,116.07913359054626\n-31.901239232369914,116.0755726228032\n-31.901184155266677,116.07458657571429\n-31.90038090818682,116.07261649319283\n-31.89991103621661,116.06925508546746\n-31.89936829355224,116.06748154547883\n-31.891469277816636,116.06745352372887\n-31.890646290477893,116.06782663367106\n-31.889546866091884,116.06810078476904\n-31.888368262024702,116.06787661076882\n-31.88663047717214,116.06734243207974\n-31.886543720513234,116.06597366729194\n-31.88615157085487,116.06527461656744\n-31.88598673939297,116.0642627532167\n-31.885110480140394,116.06292567202277\n-31.885176527262086,116.06204054304727\n-31.885855215631263,116.06061360785004\n-31.882074538904327,116.06297395178447\n-31.879947270647083,116.06378934332557\n-31.87850097349054,116.06520554968574\n-31.875888470527777,116.06456181952265\n-31.86994799627804,116.06464765021441\n-31.86316882778837,116.06486222692806\n-31.86059917393982,116.08814380117437\n-31.860043317408106,116.09270355649915\n-31.85878123726568,116.11794314332597\n-31.857373336865393,116.14344022221822\n-31.8574462383843,116.1464013809768\n-31.857118181093195,116.15202329106388\n-31.856790122635072,116.15708730168444\n-31.857482689122815,116.16446874089696\n-31.85751955406297,116.16723678190512\n-31.858577032987732,116.16996190756905\n-31.859706985308893,116.17262265891127\n-31.854202893446935,116.1756911060251\n-31.851724122267303,116.17524049491205\n-31.852817706000785,116.18408105582624\n-31.853400945356547,116.19850061148573\n-31.85238027406355,116.21807000846191\n-31.85048471169226,116.24536416738546\n-31.852526084940088,116.25738046377226\n-31.85238027406355,116.25841043203911\n-31.85239663635711,116.26759430981933\n", "-31.717600731158747,116.29356881712613\n-31.73220195004271,116.2856723937888\n-31.726945776247884,116.27657434081262\n-31.711759599556473,116.18713876343375\n-31.655410306883677,116.14008208848283\n-31.62137601951563,116.11088892556876\n-31.627743552255485,116.11071189977375\n-31.627126916420703,116.09998038150664\n-31.63061884835078,116.09392797686537\n-31.62592560672407,116.08375569917783\n-31.634377838505312,116.06902366616558\n-31.635388355210427,116.07006905712892\n-31.649259298849458,116.05326166489178\n-31.653618017319694,116.0426495049258\n-31.662451843625412,116.03347333261105\n-31.67070044183759,116.03116361537342\n-31.670833984001383,116.02105101683644\n-31.67102573651617,116.00744148829672\n-31.67082485291934,115.98228236774042\n-31.69141045091957,115.97875182630605\n-31.691769692920197,115.98007646037357\n-31.717248505377665,115.98002780342566\n-31.74337132725869,115.98061713503756\n-31.76423272520466,115.97536997983391\n-31.7669820780855,115.97036883348831\n-31.772942006944742,115.96708430091198\n-31.779852067883198,115.96699243525325\n-31.781920653426948,115.96943559238933\n-31.78136261300043,115.97771523634097\n-31.79425425401001,115.9784816775669\n-31.79603071776445,115.99976467082092\n-31.807727625236467,116.0007916215974\n-31.808105149956315,116.00834321343974\n-31.807607386850773,116.01932803282064\n-31.82236590650796,116.01760840156624\n-31.822125467692842,116.05399457850494\n-31.826089209653396,116.07132936008965\n-31.82296614617267,116.10643260292903\n-31.81867607036635,116.140162554753\n-31.8143296690625,116.19233554339908\n-31.81193017190084,116.20400549954527\n-31.810697634639613,116.24520121252304\n-31.817828942716947,116.25447017250586\n-31.825543115597466,116.25961925944242\n-31.825218648167887,116.27060407882324\n-31.82914024065414,116.2705174937635\n-31.827811222180383,116.27764068653474\n-31.815129508370823,116.29631417854559\n-31.80769793961871,116.29473162807884\n-31.805671762367776,116.31353918339222\n-31.794616231929613,116.32025524617174\n-31.78826107287844,116.3288808531768\n-31.78705319201839,116.34023177313341\n-31.787888098109175,116.35089604758231\n-31.779635459390835,116.36123826835673\n-31.799362991263482,116.37907898161667\n-31.803127113273387,116.37615772072371\n-31.81272621242143,116.34989051256854\n-31.82203259660846,116.3490291881987\n-31.831498414415563,116.34327702332901\n-31.829296200735882,116.3306584033822\n-31.842888640463716,116.31322270368318\n-31.84589283493692,116.30862472688001\n-31.845393424291192,116.29757863578695\n-31.853642965613947,116.28515925367846\n-31.856726831248725,116.27062017207719\n-31.85310358466799,116.26775406410704\n-31.85064671296067,116.24497523641323\n-31.85344674978487,116.21054506039833\n-31.852805414438322,116.1909267131139\n-31.85158082745363,116.17611488438345\n-31.852120786881862,116.17481535411592\n-31.857909773483016,116.17351582384835\n-31.858956012585082,116.17370592541218\n-31.85772951388678,116.16350129357834\n-31.85825263594459,116.11896438635885\n-31.8638441896122,116.06303965785395\n-31.86564494168029,116.01089147964143\n-31.863071939806844,115.9642364654906\n-31.842385083693745,115.96568485835834\n-31.827819483205307,115.96129676441055\n-31.793410749479992,115.9565653477089\n-31.771832655228042,115.94737073520712\n-31.67582855130654,115.91368218998468\n-31.618836193360572,115.95367929080827\n-31.57234879324945,115.9981288585969\n-31.558609232851378,116.08583709337155\n-31.578811079987148,116.108474937454\n-31.591990196844748,116.12973949052105\n-31.602243393574287,116.15237733460351\n-31.626254483924285,116.19765302276843\n-31.640011471835155,116.22269412612789\n-31.648935069611646,116.23899122810002\n-31.671007474388855,116.23743554687168\n-31.67056918225876,116.27331277464937\n-31.671153571306366,116.27434274290725\n-31.717600731158747,116.29356881712613\n", "-31.861522864645487,115.96399037282536\n-31.859121746704012,115.96099702756526\n-31.85905340277328,115.95663039128974\n-31.860812103801226,115.94652382772325\n-31.86023802373427,115.93744723241834\n-31.861413517179937,115.92905728262114\n-31.86757322224992,115.89000431937065\n-31.864256509129593,115.85695950431263\n-31.863618666000807,115.84232537192983\n-31.858606887845667,115.82700459403932\n-31.83228602561645,115.82297055167942\n-31.80449879985637,115.8206531230888\n-31.793811985026068,115.81524578971556\n-31.783707614156224,115.80932347221152\n-31.76805642716719,115.81267086906159\n-31.741942421268863,115.79944221420192\n-31.71698925493862,115.7834669773114\n-31.707656897300346,115.77607480926743\n-31.701964610747826,115.7725101534871\n-31.696271974872477,115.7710054342299\n-31.691309318017797,115.76057432337244\n-31.680647666033074,115.75089557214356\n-31.67027698635489,115.74156014366856\n-31.65936235446021,115.74065355702163\n-31.64756964111575,115.73459712906684\n-31.635629279040135,115.72854070111207\n-31.632727875201066,115.7225942437269\n-31.62456440816941,115.71802107735718\n-31.61274558143618,115.71439204856051\n-31.60121766779576,115.71007637425615\n-31.59100434093884,115.69983838244777\n-31.579619976834195,115.69097368165478\n-31.56735666715236,115.69077788039677\n-31.55553058073554,115.69109706326954\n-31.546691176266076,115.69567693516179\n-31.537735775529136,115.69178706153848\n-31.529803752258974,115.68789718791517\n-31.524758335415974,115.68936402096998\n-31.521175979740622,115.69323411330177\n-31.51327642079161,115.69573091461811\n-31.505376194014126,115.69239122911891\n-31.489427355530328,115.68348026022043\n-31.48357461119354,115.67971142127891\n-31.47684309508562,115.67937580987596\n-31.495653812563987,116.26216618455115\n-31.571937458561557,116.27825943863833\n-31.633794360017195,116.31475625669883\n-31.663246316010817,116.31618185079013\n-31.689183361971576,116.32722048198939\n-31.719016180457295,116.29600426292623\n-31.680498160253848,116.27989424503275\n-31.66912288915848,116.27510080224761\n-31.671188098082165,116.23872166610765\n-31.65077197312695,116.24080775416871\n-31.63514743075471,116.21344654001155\n-31.583737472873192,116.11842123904509\n-31.558046992163593,116.08038751521926\n-31.57272356327308,115.99909512440726\n-31.621951581994697,115.95152346532578\n-31.674659828369478,115.91356484335225\n-31.767627715206142,115.94495741765822\n-31.792897803771687,115.95563797395401\n-31.81757752364878,115.95979539792656\n-31.828893979860048,115.96105871837243\n-31.84225064952043,115.96489695947221\n-31.861522864645487,115.96399037282536\n"]
      }
      */

    });

	},

  wrangle(stg, index) {

    var clipped = stg.substring(0, stg.length - 2);

    var string =  clipped.split("\n")

    var points = string.map( item => {
      let spliced = item.split(",")
      return [ +spliced[1], +spliced[0] ]
    })

    points.push(points[0])

    var polygon = turf.polygon([points], { name: 'poly6' });

    app.writer(polygon, index)

  },

  writer: function(data, index) {

      fs.writeFile("burned-"+ index +".json", JSON.stringify(data), function(err) {

          if(err) {
              console.log(err);
          }

          //app.uploader()

      }); 

  },

  contains: function(a, b) {
      // array matches
      if (Array.isArray(b)) {
          return b.some(x => a.indexOf(x) > -1);
      }
      // string match
      return a.indexOf(b) > -1;
  }

}

app.xml()

